"use strict";(self.webpackChunkapp_app=self.webpackChunkapp_app||[]).push([[238],{41238:(e,t,s)=>{s.r(t),s.d(t,{default:()=>O});var n=s(65043),a=s(34535),r=s(68903),i=s(85865),o=s(67784),l=s(71806),c=s(40794),d=s(67254),u=s(70378),h=s(32143),x=s(73460),A=s(39652),j=s(77502),p=s(79650),m=s(84882),v=s(28076),g=s(63336),f=s(98348),y=s(95540),b=s(11906),C=s(83462),S=s(29347),w=s(35316),k=s(98533),T=s(26600),z=s(92314),E=s(55263),_=s(17392),N=s(96446),P=s(12500),W=s(67201),L=(s(34598),s(73216)),M=s(54420),U=s(1880),D=s(70579);const I=(0,a.Ay)(A.A)((e=>{let{theme:t}=e;return{["&.".concat(j.A.head)]:{backgroundColor:t.palette.common.black,color:t.palette.common.white},["&.".concat(j.A.body)]:{fontSize:14}}})),q=(0,a.Ay)(v.A)((e=>{let{theme:t}=e;return{"&:nth-of-type(odd)":{backgroundColor:t.palette.action.hover},"&:last-child td, &:last-child th":{border:0}}})),O=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!1),[A,j]=(0,n.useState)(!1),[O,F]=(0,n.useState)({}),[H,R]=(0,n.useState)(""),[J,B]=(0,n.useState)(""),[V,Y]=(0,n.useState)(""),[Z,$]=(0,n.useState)(""),[G,X]=(0,n.useState)(""),[K,Q]=(0,n.useState)(""),[ee,te]=(0,n.useState)(""),[se,ne]=(0,n.useState)(""),[ae,re]=(0,n.useState)(""),[ie,oe]=(0,n.useState)(""),[le,ce]=(0,n.useState)(""),[de,ue]=(0,n.useState)(""),[he,xe]=(0,n.useState)(""),[Ae,je]=(0,n.useState)(""),[pe,me]=(0,n.useState)(""),[ve,ge]=(0,n.useState)(""),[fe,ye]=(0,n.useState)(""),[be,Ce]=(0,n.useState)(""),[Se,we]=(0,n.useState)(!1),[ke,Te]=(0,n.useState)(""),[ze,Ee]=(0,n.useState)(""),[_e,Ne]=(0,n.useState)(null),[Pe,We]=(Boolean(_e),(0,n.useState)("")),[Le,Me]=(0,n.useState)(!1),[Ue,De]=(0,n.useState)(!1),[Ie,qe]=(0,n.useState)(null),[Oe,Fe]=(0,n.useState)(""),[He,Re]=(0,n.useState)(""),[Je,Be]=(0,n.useState)(""),[Ve,Ye]=(0,n.useState)(""),Ze=(0,L.Zp)("");(0,n.useEffect)((()=>{const e=U.A.get("token");if(e)try{const t=(0,M.s)(e),s=Date.now()/1e3;t.exp<s&&(U.A.remove("token"),Ze("/"))}catch(t){console.error("Invalid token:",t),U.A.remove("token"),Ze("/")}else Ze("/")}),[Ze]),(0,n.useEffect)((()=>{$e()}),[]);const $e=async()=>{try{const e=await fetch("/api/userdetails"),s=await e.json();200!==e.status&&400!==e.status||t(s.data)}catch(e){console.error("Error fetching user data:",e)}},Ge=async e=>{try{const t=await fetch("/api/useradmin?id=".concat(e)),s=await t.json();200!==t.status&&400!==t.status||(F(s.data),R(s.data.username||""),Y(s.data.email||""),$(s.data.phonenumber||""),X(s.data.addressline1||""),Q(s.data.addressline2||""),te(s.data.city||""),ne(s.data.pincode||""),re(s.data.state||""),Be(s.data._id),Ye(s.data.fcmToken),console.log(s.data,"databyid"))}catch(t){console.error("Error fetching user by ID:",t)}},Xe=()=>{a(!1)},Ke=()=>{j(!1)},Qe=()=>{Me(!1)},et=()=>{De(!1)},[tt,st]=(0,n.useState)(""),nt=()=>{st(!1)},at=()=>{we(!1)},rt=()=>{Ne(null),qe(null)},[it,ot]=(0,n.useState)([]);console.log(it,se,"Pincode");(0,n.useEffect)((()=>{6===fe.length&&fe&&fetch("https://api.postalpincode.in/pincode/".concat(fe)).then((async e=>{const t=await e.json();200===e.status&&"Success"===t[0].Status?ot(t[0].PostOffice||[]):ot([])})).catch((e=>console.log("error",e)))}),[fe]),(0,n.useEffect)((()=>{if(it.length>0){const e=it[0];ge(e.District||""),Ce(e.State||"")}}),[it]);const[lt,ct]=(0,n.useState)({});return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(N.A,{mb:5,sx:{flexGrow:1},children:(0,D.jsx)(z.A,{style:{backgroundColor:"#2d2859",color:"#fff"},position:"static",children:(0,D.jsxs)(E.A,{variant:"dense",children:[(0,D.jsxs)(r.Ay,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,D.jsxs)(r.Ay,{item:!0,xs:6,container:!0,direction:"row",alignItems:"center",children:[(0,D.jsx)(_.A,{edge:"start",color:"inherit","aria-label":"menu",sx:{mr:.5},children:(0,D.jsx)(P.A,{})}),(0,D.jsx)(i.A,{variant:"h6",color:"inherit",component:"div",children:"Customer List"})]}),(0,D.jsx)(r.Ay,{item:!0,xs:6,container:!0,direction:"row",justifyContent:"flex-end",alignItems:"center",children:(0,D.jsxs)(b.A,{onClick:()=>{st(!0)},color:"inherit",children:[" ",(0,D.jsx)(W.A,{sx:{mr:.5}})," Add Customer"]})})]}),(0,D.jsxs)(C.A,{open:tt,onClose:nt,"aria-labelledby":"responsive-dialog-title",children:[(0,D.jsx)(T.A,{id:"responsive-dialog-title",children:"Create User"}),(0,D.jsx)(w.A,{sx:{width:"500px"},children:(0,D.jsxs)(r.Ay,{mt:2,container:!0,spacing:2,children:[(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Name",variant:"outlined",fullWidth:!0,value:ie,onChange:e=>oe(e.target.value),error:!!lt.cname,helperText:lt.cname})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Password",variant:"outlined",fullWidth:!0,value:le,onChange:e=>ce(e.target.value),error:!!lt.cpassword,helperText:lt.cpassword})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Email",variant:"outlined",fullWidth:!0,value:de,onChange:e=>ue(e.target.value),error:!!lt.cemail,helperText:lt.cemail})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Phone Number",variant:"outlined",fullWidth:!0,value:he,onChange:e=>xe(e.target.value),error:!!lt.cphonenumber,helperText:lt.cphonenumber})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Address Line 1",variant:"outlined",fullWidth:!0,value:Ae,onChange:e=>je(e.target.value),error:!!lt.caddressLine1,helperText:lt.caddressLine1})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Address Line 2",variant:"outlined",fullWidth:!0,value:pe,onChange:e=>me(e.target.value),error:!!lt.caddressLine2,helperText:lt.caddressLine2})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Pincode",variant:"outlined",fullWidth:!0,value:fe,onChange:e=>ye(e.target.value),error:!!lt.cpincode,helperText:lt.cpincode})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"City",variant:"outlined",fullWidth:!0,value:ve,onChange:e=>ge(e.target.value),error:!!lt.ccity,helperText:lt.ccity})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"State",variant:"outlined",fullWidth:!0,value:be,onChange:e=>Ce(e.target.value),error:!!lt.cstate,helperText:lt.cstate})})]})}),(0,D.jsxs)(S.A,{children:[(0,D.jsx)(b.A,{onClick:nt,children:"Cancel"}),(0,D.jsx)(b.A,{onClick:()=>{const e=(()=>{let e={};ie||(e.cname="Name is required"),de?(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(de)||(e.cemail="Invalid email address"):e.cemail="Email is required",le?/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,16}$/.test(le)||(e.cpassword="Password must be 8-16 characters, contain uppercase, lowercase, number, and special character."):e.cpassword="Password is required";return he?10===!he.length&&(e.cphonenumber="Phone number must be 10 Digits"):e.cphonenumber="Phonenumber is required",Ae||(e.caddressLine1="Door No is required"),pe||(e.caddressLine2="Street/Area  is required"),ve||(e.ccity="City is required"),be||(e.cstate="State is required"),fe||(e.cpincode="Pincode is required"),e})();Object.keys(e).length>0?ct(e):(ct({}),(()=>{try{const e=new Headers;e.append("Content-Type","application/json");const t=JSON.stringify({username:ie,email:de,password:le,phonenumber:he,addressline1:Ae,addressline2:pe,city:ve,pincode:fe,state:be,role:"customer"});fetch("/api/register",{method:"POST",headers:e,body:t,redirect:"follow"}).then((async e=>200===e.status||400===e.status?{status_code:e.status,data:await e.json()}:{status_code:e.status,data:{msg:"Unexpected Error"}})).then((e=>{200===e.status_code?(console.log(e.data.token,"Token stored"),a(!0),Te("success"),Ee(e.data.msg||"Register Success")):400===e.status_code?(a(!0),Te("error"),Ee(e.data.msg)):401===e.status_code&&(a(!0),Te("error"),Ee("Unauthorized access"))})).catch((e=>{var t,s;console.error(e),a(!0),Te("error"),Ee((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"An Error Occurred")}))}catch(e){console.error(e),a(!0),Te("error"),Ee(e.message||"An Error Occurred")}})())},children:"Save"})]})]})]})})}),(0,D.jsxs)(p.A,{component:g.A,children:[(0,D.jsxs)(l.A,{sx:{minWidth:700},"aria-label":"customized table",children:[(0,D.jsx)(m.A,{children:(0,D.jsxs)(v.A,{children:[(0,D.jsx)(I,{children:"User Name"}),(0,D.jsx)(I,{align:"center",children:"Phone Number"}),(0,D.jsx)(I,{align:"center",children:"Mail"}),(0,D.jsx)(I,{align:"center",children:"City"}),(0,D.jsx)(I,{align:"center",children:"Details"}),(0,D.jsx)(I,{align:"center",children:"Edit"})]})}),(0,D.jsx)(x.A,{children:e.length>0?e.map(((e,t)=>"customer"===e.role&&(0,D.jsxs)(q,{children:[(0,D.jsx)(I,{component:"th",scope:"row",children:e.username}),(0,D.jsx)(I,{align:"center",children:e.phonenumber}),(0,D.jsx)(I,{align:"center",children:e.email}),(0,D.jsx)(I,{align:"center",children:e.city}),(0,D.jsx)(I,{align:"center",children:(0,D.jsx)(f.A,{onClick:()=>{return t=e._id,a(!0),void Ge(t);var t}})}),(0,D.jsxs)(I,{align:"center",children:[(0,D.jsx)(_.A,{onClick:t=>{return s=t,n=e._id,Ne(s.currentTarget),void qe(n);var s,n},children:(0,D.jsx)(y.A,{})}),(0,D.jsxs)(u.A,{anchorEl:_e,open:Boolean(_e)&&Ie===e._id,onClose:rt,MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,D.jsx)(h.A,{onClick:()=>{return t=e._id,j(!0),Ge(t),void console.log(t,"id");var t},children:"Edit"}),(0,D.jsx)(h.A,{onClick:()=>{return t=e._id,Me(!0),void Ge(t);var t},children:"Delete"}),(0,D.jsx)(h.A,{onClick:()=>{return t=e._id,De(!0),void Ge(t);var t},children:"Message"})]})]})]},t))):(0,D.jsx)(i.A,{variant:"h6",align:"center",children:"No results found for customers."})})]}),(0,D.jsxs)(C.A,{open:s,onClose:Xe,"aria-labelledby":"responsive-dialog-title",children:[(0,D.jsx)(T.A,{id:"responsive-dialog-title",children:"User Details"}),(0,D.jsx)(w.A,{sx:{width:"500px"},children:(0,D.jsxs)(r.Ay,{container:!0,spacing:2,children:[(0,D.jsxs)(r.Ay,{item:!0,xs:6,children:[(0,D.jsx)(i.A,{sx:{fontSize:"15px"},children:"Name:"}),(0,D.jsx)(i.A,{sx:{fontSize:"15px"},children:"Phone:"}),(0,D.jsx)(i.A,{sx:{fontSize:"15px"},children:"Email:"}),(0,D.jsx)(i.A,{sx:{fontSize:"15px"},children:"Address:"}),(0,D.jsx)(i.A,{sx:{fontSize:"15px"},children:"City:"}),(0,D.jsx)(i.A,{sx:{fontSize:"15px"},children:"Pincode:"})]}),(0,D.jsxs)(r.Ay,{item:!0,xs:6,children:[(0,D.jsx)(i.A,{sx:{fontSize:"15px"},children:O.username}),(0,D.jsx)(i.A,{sx:{fontSize:"15px"},children:O.phonenumber}),(0,D.jsx)(i.A,{sx:{fontSize:"15px"},children:O.email}),(0,D.jsxs)(i.A,{sx:{fontSize:"15px"},children:[O.addressline1,", ",O.addressline2]}),(0,D.jsxs)(i.A,{sx:{fontSize:"15px"},children:[O.city,", ",O.state,", ",O.pincode]}),(0,D.jsx)(i.A,{sx:{fontSize:"15px"},children:O.pincode})]})]})}),(0,D.jsx)(S.A,{children:(0,D.jsx)(b.A,{onClick:Xe,children:"Close"})})]}),(0,D.jsxs)(C.A,{open:A,onClose:Ke,"aria-labelledby":"responsive-dialog-title",children:[(0,D.jsx)(T.A,{id:"responsive-dialog-title",children:"Edit User"}),(0,D.jsx)(w.A,{sx:{width:"500px"},children:(0,D.jsxs)(r.Ay,{mt:2,container:!0,spacing:2,children:[(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Name",variant:"outlined",fullWidth:!0,value:H,onChange:e=>R(e.target.value)})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Email",variant:"outlined",fullWidth:!0,value:V,onChange:e=>Y(e.target.value)})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Phone Number",variant:"outlined",fullWidth:!0,value:Z,onChange:e=>$(e.target.value)})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Address Line 1",variant:"outlined",fullWidth:!0,value:G,onChange:e=>X(e.target.value)})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Address Line 2",variant:"outlined",fullWidth:!0,value:K,onChange:e=>Q(e.target.value)})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"City",variant:"outlined",fullWidth:!0,value:ee,onChange:e=>te(e.target.value)})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"State",variant:"outlined",fullWidth:!0,value:ae,onChange:e=>re(e.target.value)})}),(0,D.jsx)(r.Ay,{item:!0,xs:12,children:(0,D.jsx)(o.A,{label:"Pincode",variant:"outlined",fullWidth:!0,value:se,onChange:e=>ne(e.target.value)})})]})}),(0,D.jsxs)(S.A,{children:[(0,D.jsx)(b.A,{onClick:Ke,children:"Cancel"}),(0,D.jsx)(b.A,{onClick:()=>{(async e=>{try{const t=await fetch("/api/user_update?id=".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:H||O.username,email:V||O.email,phonenumber:Z||O.phonenumber,city:ee||O.city,state:ae||O.state,pincode:se||O.pincode,addressline1:G||O.addressline1,addressline2:K||O.addressline2})}),s=await t.json();200===t.status?(Ee("User updated successfully"),Te("success"),console.log(s.data,"edit data")):(Ee("Update failed"),Te("error")),we(!0),$e()}catch(t){console.error("Error updating user:",t),Ee("Update failed"),Te("error"),we(!0)}})(O._id),j(!1),rt()},children:"Save"})]})]}),(0,D.jsxs)(C.A,{open:Le,onClose:Qe,"aria-labelledby":"responsive-dialog-title",children:[(0,D.jsx)(T.A,{id:"responsive-dialog-title",children:"Delete Freelancer"}),(0,D.jsx)(w.A,{children:(0,D.jsx)(k.A,{children:"Are you sure, You want to delete this User"})}),(0,D.jsx)(S.A,{children:(0,D.jsxs)(r.Ay,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,D.jsx)(b.A,{variant:"contained",sx:{backgroundColor:"#FC4343",color:"#fff","&:hover":{backgroundColor:"#FC4343"}},onClick:Qe,children:"No"}),(0,D.jsx)(b.A,{variant:"contained",sx:{backgroundColor:"green",color:"#fff","&:hover":{backgroundColor:"green"}},onClick:()=>{(async e=>{try{const t=await fetch("/api/userdelete?id=".concat(e),{method:"DELETE",redirect:"follow"});if(200===t.status||400===t.status){const e=await t.json();We(e,"deleted data"),$e()}else console.error("Unexpected Error:",t.status)}catch(t){console.error("Error deleting user:",t)}})(O._id),Me(!1),rt()},s:!0,children:"Yes"})]})})]}),(0,D.jsx)(C.A,{open:Ue,onClose:et,"aria-labelledby":"responsive-dialog-title",children:(0,D.jsxs)(w.A,{sx:{width:"400px"},children:[(0,D.jsx)(i.A,{className:"mb-4",sx:{fontSize:"16px",width:"100%"},children:"Send Message"}),(0,D.jsxs)(r.Ay,{xs:12,container:!0,direction:"column",justifyContent:"center",alignItems:"center",children:[(0,D.jsx)(o.A,{label:"Tittle",className:"mb-4",onChange:e=>Fe(e.target.value)}),(0,D.jsx)(o.A,{label:"Message",className:"mb-2",onChange:e=>Re(e.target.value)})]}),(0,D.jsxs)(r.Ay,{mt:5,container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,D.jsx)(b.A,{variant:"contained",sx:{fontSize:"10px",backgroundColor:"#FC4343",color:"#fff","&:hover":{backgroundColor:"#FC4343"}},onClick:et,children:"Cancel"}),(0,D.jsx)(b.A,{variant:"contained",sx:{fontSize:"10px",backgroundColor:"green",color:"#fff","&:hover":{backgroundColor:"green"}},onClick:()=>{(()=>{try{const e=new Headers;e.append("Content-Type","application/json");const t=JSON.stringify({token:Ve,title:Oe,body:He,userId:Je});fetch("/api/notifications/send",{method:"POST",headers:e,body:t,redirect:"follow"}).then((async e=>200===e.status||400===e.status?{status_code:e.status,data:await e.json()}:{status_code:e.status,data:{msg:"Unexpected Error"}})).then((e=>{200===e.status_code?(console.log(e.data,"Token stored"),we(!0),Te("success"),Ee("Message Sended")):400===e.status_code&&(we(!0),Te("error"),Ee("Permisson not granted"))})).catch((e=>{var t,s;console.error(e),we(!0),Te("error"),Ee(null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)}))}catch(e){console.error(e)}})(),et(),rt()},s:!0,children:"Send"})]})]})}),(0,D.jsx)(c.A,{open:Se,autoHideDuration:6e3,onClose:at,children:(0,D.jsx)(d.A,{onClose:at,severity:ke,children:ze})})]})]})}},67201:(e,t,s)=>{var n=s(24994);t.A=void 0;var a=n(s(40039)),r=s(70579);t.A=(0,a.default)((0,r.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11h-4v4h-2v-4H7v-2h4V7h2v4h4z"}),"AddCircle")},12500:(e,t,s)=>{var n=s(24994);t.A=void 0;var a=n(s(40039)),r=s(70579);t.A=(0,a.default)([(0,r.jsx)("path",{d:"m12 2-5.5 9h11z"},"0"),(0,r.jsx)("circle",{cx:"17.5",cy:"17.5",r:"4.5"},"1"),(0,r.jsx)("path",{d:"M3 13.5h8v8H3z"},"2")],"Category")},98348:(e,t,s)=>{var n=s(24994);t.A=void 0;var a=n(s(40039)),r=s(70579);t.A=(0,a.default)((0,r.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info")},79650:(e,t,s)=>{s.d(t,{A:()=>p});var n=s(58168),a=s(98587),r=s(65043),i=s(58387),o=s(98610),l=s(6431),c=s(34535),d=s(92532),u=s(72372);function h(e){return(0,u.Ay)("MuiTableContainer",e)}(0,d.A)("MuiTableContainer",["root"]);var x=s(70579);const A=["className","component"],j=(0,c.Ay)("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,t)=>t.root})({width:"100%",overflowX:"auto"}),p=r.forwardRef((function(e,t){const s=(0,l.b)({props:e,name:"MuiTableContainer"}),{className:r,component:c="div"}=s,d=(0,a.A)(s,A),u=(0,n.A)({},s,{component:c}),p=(e=>{const{classes:t}=e;return(0,o.A)({root:["root"]},h,t)})(u);return(0,x.jsx)(j,(0,n.A)({ref:t,as:c,className:(0,i.A)(p.root,r),ownerState:u},d))}))}}]);
//# sourceMappingURL=238.8d2e25bd.chunk.js.map